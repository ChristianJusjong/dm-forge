<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Encounter Builder - Dungeon Master Forge</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Lato:wght@300;400;700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="design-system.css">
  <link rel="stylesheet" href="medieval-theme.css">
  <link rel="stylesheet" href="responsive-design.css">
  <link rel="stylesheet" href="global-overrides.css">
  <link rel="manifest" href="manifest.json">
</head>

<body>
  <div id="app">
    <!-- Navigation will be inserted here by nav.js -->

    <!-- Encounter Builder Content -->
    <main class="page-content">
      <div class="page-header">
        <h1 class="page-title">ğŸ‘¹ Encounter Builder</h1>
        <p class="page-subtitle">Design balanced encounters with AI assistance</p>
      </div>

      <button id="new-encounter-btn" class="btn btn-large" style="width: 100%; margin-bottom: 2rem;">+ New
        Encounter</button>

      <div id="encounters-list" class="encounters-grid">
        <!-- Empty State -->
        <div id="no-encounters" class="empty-state"
          style="grid-column: 1 / -1; text-align: center; padding: 4rem 2rem; background: rgba(0,0,0,0.2); border-radius: var(--border-radius-lg); border: 2px dashed var(--color-gold-light);">
          <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.7;">âš”ï¸</div>
          <h3 class="text-gold" style="margin-bottom: 0.5rem;">No Encounters Yet</h3>
          <p
            style="color: var(--color-parchment); margin-bottom: 1.5rem; max-width: 500px; margin-left: auto; margin-right: auto;">
            Create balanced combat scenarios for your party. We'll track initiative, HP, and XP automatically.
          </p>
          <button class="btn btn-primary" onclick="showCreateModal()">
            <span class="icon">â•</span> Create First Encounter
          </button>
        </div>
      </div>

      <!-- New Encounter Modal -->
      <div id="new-encounter-modal" class="modal-overlay" style="display: none;">
        <div class="modal large">
          <h3>Create New Encounter</h3>

          <div class="input-group">
            <label class="input-label">Encounter Name</label>
            <input id="new-encounter-name" type="text" placeholder="e.g., Goblin Ambush" class="input">
          </div>

          <div class="input-group">
            <label class="input-label">Description / Setting</label>
            <textarea id="new-encounter-description" placeholder="e.g., Dark forest path at night, fog rolling in..."
              class="textarea" rows="3"></textarea>
          </div>

          <button id="suggest-creatures-btn" class="btn btn-secondary" style="width: 100%; margin-bottom: 1rem;">
            <span id="suggest-btn-text">âœ¨ Suggest Creatures (AI)</span>
            <span id="suggest-btn-loading" style="display: none;">â³ Generating suggestions...</span>
          </button>

          <!-- AI Suggestions Area -->
          <div id="ai-suggestions" style="display: none; margin-bottom: 2rem;">
            <div class="card">
              <h4 class="text-gold mb-md">AI Suggestions</h4>
              <div id="suggestions-list" style="display: grid; gap: 0.75rem;">
                <!-- Suggestions will appear here -->
              </div>
            </div>
          </div>

          <div class="modal-actions">
            <button id="create-encounter-btn" class="btn">Create Encounter</button>
            <button id="cancel-encounter-btn" class="btn btn-secondary">Cancel</button>
          </div>
        </div>
      </div>

      <!-- Edit Encounter Modal -->
      <div id="edit-encounter-modal" class="modal-overlay" style="display: none;">
        <div class="modal large">
          <h3><span data-i18n="edit">Edit</span>: <span id="edit-encounter-title"></span></h3>

          <!-- Add Creature Form -->
          <div class="card mb-lg">
            <h4 class="text-gold mb-md">Add Creatures</h4>
            <div class="creature-form-grid">
              <div class="input-group">
                <label class="input-label" data-i18n="creatureName">Creature Name</label>
                <input id="edit-creature-name" type="text" class="input">
              </div>
              <div class="input-group">
                <label class="input-label" data-i18n="hp">HP</label>
                <input id="edit-creature-hp" type="number" value="10" class="input">
              </div>
              <div class="input-group">
                <label class="input-label" data-i18n="ac">AC</label>
                <input id="edit-creature-ac" type="number" value="12" class="input">
              </div>
              <div class="input-group">
                <label class="input-label" data-i18n="cr">CR</label>
                <input id="edit-creature-cr" type="number" value="0.25" step="0.125" class="input">
              </div>
              <div class="input-group">
                <label class="input-label" data-i18n="count">Count</label>
                <input id="edit-creature-count" type="number" value="1" min="1" class="input">
              </div>
              <button id="add-creature-btn" class="btn" style="height: fit-content; align-self: end;"
                data-i18n="add">Add</button>
            </div>
          </div>

          <!-- Creatures List -->
          <div class="card">
            <h4 class="text-gold mb-md">Creatures in Encounter</h4>
            <div id="edit-creatures-list" class="creatures-list">
              <!-- Creatures will be rendered here -->
            </div>
            <div id="no-creatures-in-edit" class="empty-state" style="display: none; padding: 2rem;">
              <p>No creatures yet. Add some above!</p>
            </div>
          </div>

          <div class="modal-actions" style="margin-top: 1.5rem;">
            <button id="save-encounter-btn" class="btn" data-i18n="save">Save Changes</button>
            <button id="close-edit-modal-btn" class="btn btn-secondary" data-i18n="close">Close</button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="storage-utils.js"></script>
  <script type="module" src="auth.js"></script>
  <script type="module" src="translations.js"></script>
  <script type="module" src="campaign-manager.ts"></script>
  <script type="module" src="nav.js"></script>
  <script type="module" src="tutorial.js"></script>
  <script type="module" src="ads.js"></script>
  <script type="module" src="encounters.js"></script>
</body>

</html>